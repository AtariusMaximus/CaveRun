 rem
 rem Cave Run
 rem
 rem by Steve Engelhardt
 rem 8/2/2012
 rem

 rem
 rem Define Variables
 rem
 def GRAVITY=0.05
 def JUMPVELOCITY=1.2
 def REFLECT=flags{3}
 def JUMPING=flags{4}

 rem
 rem Set Romsize & smartbranching
 rem
 set romsize 32kSC
 set smartbranching on

 rem
 rem Set Constants
 rem
 const pfres=24
 const noscore=1

 rem
 rem dim Variables
 rem
 dim yvel=a.b
 dim ypos=c.d
 dim flags=e
 dim duration=var20
 dim rand16=var21
 dim count=flags 
 dim rjoy=flags 
 dim score1=score
 dim score2=score+1
 dim score3=score+2

 rem
 rem Varaible assignments
 rem
 rem a = Used for Jump Velocity 
 rem b = Used for Jump Velocity 
 rem c = Used for player y position (dim yvel=a.b)
 rem d = used for player y position (dim ypos=c.d)
 rem e = Bit variable used for flags in jumping routines
 rem f = not used
 rem g = Room Number
 rem h = not used
 rem i = not used
 rem j = Used for bat movement
 rem k = Frame counter in main loop
 rem l = Frame counter for explosion animation
 rem m = not used
 rem n = not used
 rem o = not used
 rem p = not used
 rem q = Counter used for treasure movement
 rem r = Counter used for treasure movement
 rem s = Counter used for treasure movement
 rem t = Counter used for treasure movement
 rem u = Counter used in titlescreen to reseed random number
 rem v = not used
 rem w = not used
 rem x = not used
 rem y = not used
 rem z = Used in collision detection routine
 rem
 rem var1 = player0x position
 rem var2 = player0y position
 rem var3 = flag for secret room
 rem var4 = not used
 rem
 rem Bit variables for keeping track of treasure placement
 rem
 rem var5 
 rem   {0} - Room 0 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 1 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 2 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 3 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 4 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 5 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 6 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} - Room 7 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem var6
 rem   {0} - Room 8 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 9 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 10 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 11 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 12 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 13 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 14 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} - Room 15 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem var7
 rem   {0} - Room 16 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 17 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 18 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 19 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 20 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 21 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 22 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} - Room 23 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem var8
 rem   {0} - Room 24 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 25 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 26 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 27 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 28 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 29 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 30 missile0 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} 
 rem var9 
 rem   {0} - Room 0 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 1 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 2 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 3 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 4 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 5 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 6 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} - Room 7 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem var10
 rem   {0} - Room 8 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 9 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 10 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 11 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 12 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 13 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 14 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} - Room 15 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem var11
 rem   {0} - Room 16 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 17 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 18 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 19 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 20 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 21 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 22 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} - Room 23 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem var12
 rem   {0} - Room 24 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {1} - Room 25 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {2} - Room 26 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {3} - Room 27 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {4} - Room 28 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {5} - Room 29 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {6} - Room 30 missile1 treasure flag (1 if picked up, 0 if not picked up)
 rem   {7} - Flag for getting hit by the bat.  Bat disappears from current screen when hit.
 rem
 rem var13 = not used
 rem var14 = treasure counter
 rem var15 = not used
 rem var16 = Used as frame counter on the map screen
 rem var17 = not used
 rem var18 = not used
 rem var19 = not used
 rem var20 = Used for audio/duration
 rem var21 = random number
 rem var22 = Used as frame counter on win screen
 rem var23 = used for joystick movement on options screen
 rem var24 = not used
 rem var25 = Used as frame counter for bat bounce routine
 rem var26 = Used for counter for treasure movement
 rem var27 = Used for counter for treasure movement
 rem var28 = not used
 rem var29 = not used
 rem var30 = not used
 rem var31 = not used  
 rem var32 = not used
 rem var33 = not used
 rem var34 = not used
 rem
 rem Bit variables for game options
 rem
 rem var35{0} speed high if on
 rem var35{1} speed low if on
 rem var35{2} god mode off if on
 rem var35{3} god mode on if on
 rem var35{4} high gravity high if on
 rem var35{5} high gravity low if on
 rem var35{6} velocity high if on
 rem var35{7} velocity low if on
 rem
 rem var36 = not used
 rem var37 = Used as frame counter on the options screen
 rem var38 = used for joystick movement on options screen
 rem var39 = Reverse counter used for jumping sound
 rem var40 = Used on options screen
 rem
 rem Bit variables for game options
 rem
 rem var41{0} player speed
 rem var41{1} player speed
 rem var41{2} random start
 rem var41{3} random start
 rem
 rem var42 = not used
 rem var43 = not used
 rem var44 = not used
 rem var45 = not used
 rem var46 = not used

 rem
 rem Set data tables for room shape and movement
 rem
   data room_shape
   0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30
end
   data move_east
   1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,29
end
   data move_west
   0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30
end

 rem
 rem set initial variable values
 rem 
 missile0height=2
 missile1height=2
 var5{0}=0    : rem set initial treasure value to 0
 var8{0}=0    : rem set initial treasure value to 0   
 var14=0      : rem counter for how many treasure pieces you've picked up
 var27=60     : rem start point for ball obstacle
 c=19         : rem initial Y location of player
 score=000003 : rem set initial life counter to 3

 goto titlestart bank7 : rem jump to titlescreen

 rem
 rem Set Options for entering Room 30, the final room on the map
 rem This was moved to bank1 to free up space in a different bank
 rem

Room_30

 rem
 rem Change bat sprite to a gate sprite
 rem
 player1:
 %11100111
 %11100111
 %11100111
 %11100111
 %11100111
 %11100111
 %11100111
 %11111111
 %11111111
end

 player1x=112:player1y=60 : rem position cave gate

 rem
 rem Check for collisions with treasures
 rem
 if !var8{6} then missile0x=105:missile0y=78 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var8{6}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var12{6} then missile1x=132:missile1y=78 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var12{6}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0

 rem
 rem Reposition the barrier when you move farther right on the screen
 rem
 if player0x<65 then ballx=50:bally=r-27
 if player0x>65 then ballx=78:bally=r-27
 return otherbank

 rem
 rem Room data for Room 31
 rem  This is the "win screen", it's not on the map.
 rem
Room_31
 COLUPF=144
 ballx=0:bally=0
 COLUP1=28
 player1:
 %11111111
 %00111100
 %00011000
 %00011000
 %00111100
 %01100110
 %11000011
 %11000011
end

 missile0x=0:missile0y=0
 missile1x=0:missile1y=0
 player1x=29:player1y=40

 rem
 rem grab the final treasure, win the game, hear a tune.
 rem
 if collision(player0,player1) then var8{7}=1

 if var8{7} then AUDV0=0:AUDV1=0:duration=1:goto MusicSetup2
 return otherbank

winner

 gosub finalscreen bank8
 drawscreen
 COLUP0=242
 var22=var22+1
 if var22>250 then var22=0
 if switchreset then reboot
 COLUP1=var22

   goto GetMusic2
GotMusic2

 goto winner

GetMusic2

   duration = duration - 1
   if duration>0 then GotMusic2
   temp4 = sread(musicData2)
   temp5 = sread(musicData2)
   temp6 = sread(musicData2)
   if temp4=255 then duration = 1 : goto MusicSetup2
   AUDV0 = temp4
   AUDC0 = temp5
   AUDF0 = temp6
   temp4 = sread(musicData2)
   temp5 = sread(musicData2)
   temp6 = sread(musicData2)
   AUDV1 = temp4
   AUDC1 = temp5
   AUDF1 = temp6
   duration = sread(musicData2)
   goto GotMusic2

MusicSetup2
   sdata musicData2=x
  8,4,3
  0,0,0
  11
  2,4,3
  0,0,0
  11
  8,4,4
  0,0,0
  11
  8,4,5
  0,0,0
  11
  8,4,7
  0,0,0
  11
  8,4,8
  0,0,0
  11
  8,4,9
  0,0,0
  11
  8,4,11
  0,0,0
  11
  8,4,14
  0,0,0
  11
  8,4,15
  0,0,0
  11
  8,4,17
  0,0,0
  11
  8,4,19
  0,0,0
  11
  8,4,21
  0,0,0
  11
  8,4,23
  0,0,0
  11
  8,4,26
  0,0,0
  11
  8,4,29
  0,0,0
  11
  8,4,31
  0,0,0
  11
  8,4,29
  0,0,0
  11
  8,4,26
  0,0,0
  11
  8,4,23
  0,0,0
  11
  8,4,21
  0,0,0
  11
  8,4,19
  0,0,0
  11
  8,4,17
  0,0,0
  11
  8,4,15
  0,0,0
  11
  8,4,14
  0,0,0
  11
  8,4,11
  0,0,0
  11
  8,4,9
  0,0,0
  11
  8,4,8
  0,0,0
  11
  8,4,7
  0,0,0
  11
  8,4,5
  0,0,0
  11
  8,4,4
  0,0,0
  11
  8,4,3
  0,0,0
  11
  8,4,4
  0,0,0
  11
  8,4,5
  0,0,0
  32
  2,4,5
  0,0,0
  8
  8,4,4
  0,0,0
  11
  8,4,3
  0,0,0
  9
  2,4,3
  0,0,0
  8
  8,4,4
  0,0,0
  11
  8,4,5
  0,0,0
  32
  2,4,5
  0,0,0
  8
  8,4,3
  0,0,0
  15
  2,4,3
  0,0,0
  8
  8,4,3
  0,0,0
  15
  2,4,3
  0,0,0
  8
  8,4,5
  0,0,0
  43
  2,4,5
  0,0,0
  8
  8,4,4
  0,0,0
  15
  2,4,4
  0,0,0
  8
  8,4,4
  0,0,0
  15
  2,4,4
  0,0,0
  8
  8,4,5
  0,0,0
  43
  2,4,5
  0,0,0
  8
  255
end
   goto GotMusic2

 rem
 rem  Beginning of Game - start point after hitting fire button on titlescreen
 rem
begingame
 missile0x=0:missile0y=0
 missile1x=0:missile1y=0
 player1x=0:player1y=0
 drawscreen

 rem
 rem Generate random number between 0-30.  This is used
 rem  for placing the player in a random map room if that option is selected.
 rem
getr31
 temp1=rand%31 : rem only use the bottom 5 bits, for a range of 0-31
 if temp1>30 then goto getr31 : rem if it's 31, get another number

 if var41{3} then g=temp1
 if var41{3} then goto start2 bank2
 goto start bank2

 bank 2

start
 g = 0          :rem  starting room

start2
 r = 120        :rem  treasure movement X
 rem s = 88     :rem  treasure movement Y

 gosub draw_room

 player0x=30:player0y=35
 player1x=80:player1y=45
 m{0}=0:l=0
 var39=14
 scorecolor=8
 missile0height=2
 missile1height=2
 ballheight=6
 
 rem
 rem MAIN GAME LOOP
 rem

continue

 COLUP0=248

 rem
 rem AUDIO
 rem 

 if !joy0left && !joy0right && !joy0up && !joy0down && !joy0fire && JUMPING then AUDV0=0
 if !joy0left && !joy0right && !joy0up && !joy0down && !joy0fire then AUDV1=0

 var39=var39-1
 if var39<0 then var39=8 
 if !JUMPING then var39=8
 
 rem
 rem walking sound
 rem
 rem if JUMPING then goto skipaud1
 if joy0right || joy0left then AUDF1=k:AUDC1=2:AUDV1=2
skipaud1

 rem
 rem jumping sound  
 rem
 if temp2=0 then skipaud2
 if JUMPING && joy0fire then AUDF0=var39:AUDC0=6:AUDV0=7 else AUDV0=0
skipaud2

 rem
 rem set ballheight taller if you're on the final screen
 rem
 if g=30 then ballheight=48 else ballheight=6

 rem
 rem reflect the bat sprite so it's always facing you
 rem 
 rem if player0x<player1x then REFP1=8 else REFP1=0

 rem
 rem set NUSIZ values
 rem
 NUSIZ0=$10
 NUSIZ1=$10

 rem
 rem set var1/var2 to equal the position of the player sprite
 rem
 var1=player0x:var2=player0y

 rem
 rem hit the BW switch to switch to the map screen
 rem
 if switchbw then gosub map bank6

 rem
 rem counter
 rem
 k=k+1
 if k>12 then k=0

 rem
 rem set color of bat sprite to red
 rem
 COLUP1=66

 rem
 rem restart the game if you hit reset
 rem
 if switchreset then reboot

 rem
 rem delays bat sprite movement with the k counter
 rem
 rem var35{0}=1 then high speed option selected
 rem var35{0}=0 then normal (low) speed option selected
 rem
 if var35{0} then skipnext1
 if k>4 && g<30 && !var12{7} then gosub batbounce
skipnext1
 if k>1 && var35{0} && g<30 && !var12{7} then gosub batbounce
 rem
 rem bit 7 of var12 is flagged when you get hit by the bat
 rem  it will disappear from the screen until you move off the screen again
 rem  the bit is reset with a room change
 rem
 if !var12{7} then skip3
 player1:
 %00000000
end
skip3

 rem
 rem The following section is to create back and forth moving 
 rem  treasure sprites and barriers
 rem 

   if q=1 then r=r+1
   if q=2 then r=r-1
   if r<30 then q=1
   if r>115 then q=2

   if t=1 then s=s+1
   if t=2 then s=s-1
   if s<40 then t=1
   if s>88 then t=2

   if var26=1 then var27=var27+1
   if var26=2 then var27=var27-1
   if var27<61 then var26=1
   if var27>101 then var26=2

 rem
 rem Change Rooms
 rem

 if player0x>139 && g<31 then g=g+1:player1x=80:player1y=45:gosub go_east
 if player0x<16  && g<31 then g=g-1:player1x=80:player1y=45:gosub go_west

 rem
 rem Secret Room
 rem 
 if g=29 && player0y>90 && var35{2} then var12{7}=1:var3{0}=1:missile0x=0:missile0y=0:missile1x=0:missile1y=0:gosub secret bank3

 rem
 rem collision detection
 rem
 rem if you're in room 31 (final screen) or you've selected god mode on the options screen, skip collision routines
 rem
 if g=31 || var35{3} then goto skipcolldet

 rem
 rem detect collisions between player and bat sprite, as well as if you've fallen in a pit
 rem
 if z=0 && g<>30 && collision(player0,player1) then var12{7}=1:z=1:score=score-1:l=0:gosub explode bank4
 if !collision(player0,player1) then z=0
 if var3=1 then skipcolldet
 if y=0 && player0y > 90 then y=1:score=score-1:l=0:var12{7}=1:gosub explode bank4
 if !collision(player0,player1) then y=0

 rem
 rem if you collide with a ball barrier, it pushes you to the right
 rem 
 if collision(player0,ball) then player0x=ballx

skipcolldet

 rem
 rem goto final screen
 rem  will work if you've collected all 62 treasures and touch the cave gate
 rem
 if g=30 && var14>61 && collision(player0,player1) then g=31:gosub draw_room

 rem
 rem change the room playfield based on the room number you're in
 rem
 if g=0 then gosub Room_0 bank5
 if g=1 then gosub Room_1 bank5
 if g=2 then gosub Room_2 bank5
 if g=3 then gosub Room_3 bank5
 if g=4 then gosub Room_4 bank5
 if g=5 then gosub Room_5 bank5
 if g=6 then gosub Room_6 bank5
 if g=7 then gosub Room_7 bank5
 if g=8 then gosub Room_8 bank5
 if g=9 then gosub Room_9 bank5
 if g=10 then gosub Room_10 bank5
 if g=11 then gosub Room_11 bank5
 if g=12 then gosub Room_12 bank5
 if g=13 then gosub Room_13 bank5
 if g=14 then gosub Room_14 bank5
 if g=15 then gosub Room_15 bank5
 if g=16 then gosub Room_16 bank5
 if g=17 then gosub Room_17 bank5
 if g=18 then gosub Room_18 bank5
 if g=19 then gosub Room_19 bank5
 if g=20 then gosub Room_20 bank5
 if g=21 then gosub Room_21 bank5
 if g=22 then gosub Room_22 bank5
 if g=23 then gosub Room_23 bank5
 if g=24 then gosub Room_24 bank5
 if g=25 then gosub Room_25 bank5
 if g=26 then gosub Room_26 bank5
 if g=27 then gosub Room_27 bank5
 if g=28 then gosub Room_28 bank5
 if g=29 && !var3{0} then gosub Room_29 bank5
 if g=30 then gosub Room_30 bank1
 if g=31 then gosub Room_31 bank1

 
 drawscreen

 rem
 rem Jumping Code
 rem
 rem this code was taken from batari's platformer demo
 rem  I didn't write it and I haven't added any comments to it
 rem

  count=count+32
 if JUMPING then werejumping
 if !joy0fire then nobutton

 rem
 rem Change Jump velocity based on player option chosen
 rem
 rem var35{6}=0: rem velocity high if on
 rem var35{7}=1: rem velocity low if on

 if var35{7} then yvel=1.2
 if var35{6} then yvel=1.8

 JUMPING=1
nobutton
 if !JUMPING then nojump
werejumping

 rem
 rem Change Jump gravity based on player option chosen
 rem
 rem var35{4}=0: rem high gravity high if on
 rem var35{5}=1: rem high gravity low if on

 if var35{5} then yvel=yvel-0.03
 if var35{4} then yvel=yvel-0.05

 ypos=ypos-yvel
nojump
 temp1=a|b:if temp1=0 then checkfall
 if !a{7} then skipadd
checkfall
 if player0x<10 || player0x>142 then keepfall

 rem height from XY
 rem 0=keep falling, 1=hit exactly, 2=hit too low, move up
 gosub heightread

 temp3=c+2
 temp3=temp3&3
 if temp2=0 then keepfall
 if temp3=1 then stopjump
 if temp3>1 then addandstop
keepfall
 JUMPING=1
 goto skipadd
addandstop
 c=c-1
stopjump
 JUMPING=0:d=255:a=0:b=0
skipadd
 if c>$64 then c=0
 player0y=c
 if count{5} then neg
 rjoy=(rjoy & %11111000) | (SWCHA/32)

 if rjoy{0} then noduck
 player0:
        %00011100
        %00011000
        %01011010
        %01111100
        %00100100
        %00011000
        %00111100
        %00011000
end

 goto neg
noduck
 if rjoy{1} then check7
 REFLECT=1
 temp1=blockread(player0x,c)

 rem
 rem Change Player run speed based on option chosen
 rem
 if temp1=0 then player0x=player0x-1
 if temp1=0 && var41{0} then player0x=player0x-1

 rem if player0x<7 then player0x=player0x+1
 rem goto donereadingjoy
check7
 if rjoy{2} then donereadingjoy
 REFLECT=0
 temp1=player0x+7
 temp1=blockread(temp1,c)

 rem
 rem Change Player run speed based on option chosen
 rem
 if temp1=0 then player0x=player0x+1
 if temp1=0 && var41{0} then player0x=player0x+1
  
 rem if player0x>$91 then player0x=player0x-1
donereadingjoy
 if !rjoy{2} || !rjoy{1} then running
 player0:
        %00011100
        %00011000
        %00011000
        %00100000
        %01011010
        %01111100
        %00100100
        %00010000
        %00011000
        %00111100
        %00011000
end
 goto neg
running
 if count{6} then frame24
 if count{7} then frame3
 player0:
 %01100011
        %00011100
        %00011000
        %00011000
        %00100000
        %01011010
        %01111100
        %00100100
        %00010000
        %00011000
        %00111100
        %00011000
end
 goto neg
frame3
 player0:
        %00000110
        %00100100
        %00110100
        %00011000
        %00000000
        %10011110
        %01100100
        %00010000
        %00011000
        %00111100
        %00011000
end
 goto neg
frame24
 if !count{7} then frame2
 player0:
        %01000000
        %01100011
        %00110110
        %00011100
        %00101000
        %00111100
        %00100100
        %00010000
        %00011000
        %00111100
        %00011000
end
 goto neg
frame2
 player0:
        %00011100
        %00011000
        %00011000
        %00100000
        %01011010
        %01111100
        %00100100
        %00010000
        %00011000
        %00111100
        %00011000
end
neg

 goto continue

 function pfget
 if pfread(temp1,temp2) then temp1=1 else temp1=0
 return thisbank

 function blockread
 temp1=temp1-17:temp1=temp1/4
 temp2=temp2/4
 rem pfpixel temp1 temp2 flip
 if temp1>31 then temp1=0:return thisbank
 temp1=pfget(temp1,temp2)
 return thisbank

heightread
 temp5=c+1
 temp5=temp5/4
 temp3=player0x-16
 temp4=temp3+1:temp4=temp4/4
 temp3=temp3/4:if temp3>$3d then temp6=0:temp4=0:goto skipfirst

 temp6=pfget(temp3,temp5)
 if temp4>temp3 then temp3=pfget(temp4,temp5):temp6=temp6|temp3
 temp4=temp4+1
skipfirst
 temp2=temp6
 rem pfpixel temp4 temp5 flip 
 if temp4<$20 then temp2=pfget(temp4,temp5):temp2=temp2|temp6
 return thisbank

 rem
 rem END of batari's jumping code
 rem

 rem
 rem Room movement code
 rem

go_east
   player0x = 24    :rem initial placement when you move right
   h = move_east[g]
   r = 80
   var12{7}=0       :rem reset flag to display bat sprite again
   var3{0}=0        :rem reset flag for secret room
  
   goto draw_room

go_west
   player0x = 136   :rem initial placement when you move left
   h = move_west[g]
   r = 80
   var12{7}=0       :rem reset flag to display bat sprite again
   var3{0}=0        :rem reset flag for secret room
  

draw_room
   if g = 0 then COLUPF=144:goto draw_room_shape_0 bank3
   if g = 1 then COLUPF=146:goto draw_room_shape_1 bank3
   if g = 2 then COLUPF=148:goto draw_room_shape_2 bank3
   if g = 3 then COLUPF=150:goto draw_room_shape_3 bank3
   if g = 4 then COLUPF=152:goto draw_room_shape_4 bank3
   if g = 5 then COLUPF=156:goto draw_room_shape_5 bank3
   if g = 6 then COLUPF=158:goto draw_room_shape_6 bank3
   if g = 7 then COLUPF=160:goto draw_room_shape_7 bank3
   if g = 8 then COLUPF=162:goto draw_room_shape_8 bank3
   if g = 9 then COLUPF=164:goto draw_room_shape_9 bank3
   if g = 10 then COLUPF=166:goto draw_room_shape_10 bank3
   if g = 11 then COLUPF=168:goto draw_room_shape_11 bank3
   if g = 12 then COLUPF=170:goto draw_room_shape_12 bank3
   if g = 13 then COLUPF=172:goto draw_room_shape_13 bank3
   if g = 14 then COLUPF=194:goto draw_room_shape_14 bank3
   if g = 15 then COLUPF=196:goto draw_room_shape_15 bank3
   if g = 16 then COLUPF=198:goto draw_room_shape_16 bank3
   if g = 17 then COLUPF=200:goto draw_room_shape_17 bank3
   if g = 18 then COLUPF=202:goto draw_room_shape_18 bank3
   if g = 19 then COLUPF=204:goto draw_room_shape_19 bank3
   if g = 20 then COLUPF=206:goto draw_room_shape_20 bank3
   if g = 21 then COLUPF=210:goto draw_room_shape_21 bank3
   if g = 22 then COLUPF=212:goto draw_room_shape_22 bank3
   if g = 23 then COLUPF=214:goto draw_room_shape_23 bank3
   if g = 24 then COLUPF=216:goto draw_room_shape_24 bank3
   if g = 25 then COLUPF=218:goto draw_room_shape_25 bank3
   if g = 26 then COLUPF=48:goto draw_room_shape_26 bank3
   if g = 27 then COLUPF=50:goto draw_room_shape_27 bank3
   if g = 28 then COLUPF=52:goto draw_room_shape_28 bank3
   if g = 29 then COLUPF=54:goto draw_room_shape_29 bank3
   if g = 30 && var14<60 then COLUPF=2:goto draw_room_shape_30 bank3
   if g = 30 && var14>59 then COLUPF=190:goto draw_room_shape_30_final bank3
   if g = 31 then COLUPF=46:goto draw_room_shape_31 bank3

   rem must have all 60 treasure pieces to unlock last room. That's why there
   rem are two options for room_shape_30

batbounce

 rem
 rem This subroutine bounces the bat around the screen
 rem
 rem var35{0}=1 then high speed option selected
 rem var35{0}=0 then normal (low) speed option selected

  var25=var25+1
  if var25>15 then var25=0

  if var25=5 then player1:
  %00000000
  %00000000
  %00000000
  %00000000
  %00000000
  %00010100
  %10101000
  %01111111
  %00111010
  %01111110
  %11101010
  %11110001
  %01110011
  %01110011
  %10010001
  %00010000
end

  if var25=10 then player1:
  %00000000
  %00000000
  %00000000
  %00000000
  %00000000
  %00010100
  %10101000
  %11111111
  %11111010
  %11111111
  %11101011
  %00000000
  %00000000
  %00000000
  %00000000
  %00000000
end
 
  if var25=15 then player1:
  %00000000
  %00010000
  %10010000
  %01110000
  %01110000
  %01110101
  %11101011
  %01111111
  %00111010
  %01111110
  %11101010
  %00000000
  %00000000
  %00000000
  %00000000
  %00000000
end


 if j = 10 && player1y > 88 then j=j+10
 if j = 10 && player1x > 150 then j=j+30

 if j = 20 && player1x > 150 then j=j+10
 if j = 20 && player1y < 12 then j=j-10

 if j = 30 && player1y < 12 then j=j+10
 if j = 30 && player1x < 2 then j=j-10
 
 if j = 40 && player1y > 88 then j=j-10
 if j = 40 && player1x < 2 then j=j-30
 
 if j < 10 then j=10
 if j > 40 then j=10
 
 if j = 10 then goto moveupandright
 if j = 20 then goto movedownandright
 if j = 30 then goto movedownandleft
 if j = 40 then goto moveupandleft
  
 return thisbank

moveupandright 
 player1x = player1x + 1
 player1y = player1y + 1
 return thisbank
 
moveupandleft
 player1x = player1x - 1
 player1y = player1y + 1
 return thisbank
 
movedownandright
 player1x = player1x + 1
 player1y = player1y - 1
 return thisbank
 
movedownandleft
 player1x = player1x - 1
 player1y = player1y - 1
 return thisbank

 bank 3

draw_room_shape_0
   playfield:
   X...............................
   X...............................
   X.......................X.......
   X...............................
   X...............................
   X...............................
   X..XXXXXXXXX.....XXX............
   X.............................XX
   X...........XXXXXX..............
   X.........................XX....
   X...............................
   X.....................XX........
   X...............................
   X...xxxxxx........XX............
   X...............................
   X..............X................
   X...............................
   X...............................
   X......X............XXXXXXXXXXXX
   X...............................
   X...............................
   X...............................
   X..........XXXXXXXXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_1
   playfield:
   ................................
   ................................
   ................................
   .........................XXXXXXX
   ..........X......XXX............
   ................................
   ................................
   ...............XXX..............
   ................................
   XXXXX...............XXXXXXXXX...
   ................................
   ................XXX.............
   ................................
   ...........XXX..................
   ................................
   .XXXXXXXXX......................
   ................................
   ................................
   XXX........XXXXXX...............
   ...X......................XXX...
   ................X...............
   ................................
   XXXXXXXX..........XXXX.....XXXXX
end
   return otherbank

draw_room_shape_2
   playfield:
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   XXXXXXXX........................
   X...............................
   X......................XXXXXXXXX
   X...............................
   X....XXXXXXXX...................
   X...............................
   X...............XXXXXXXXX.......
   XXXXXX..........................
   .....X..........................
   .....X...............X..........
   .....X..........................
   .....X..........................
   .....X.............XXXXXXXXXXXXX
   XXXXXX.............XXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_3
   playfield:
   ................................
   ................................
   .........................XXXXXXX
   .....X..........................
   ................................
   ................................
   ..........XXXXXXXXX.............
   ................................
   ................................
   XXX.....................XXXXX...
   .......X........................
   ................................
   .......................X........
   ................................
   ........XXXXXXXXXXXX............
   ................................
   ................................
   ...X..................XXXXXXXXXX
   ................................
   ................................
   ................................
   XXXXXXXXX.......................
   ...............X................
end
   return otherbank

draw_room_shape_4
   playfield:
   ................................
   ................................
   XXXXXXXXXXXXX...................
   ................................
   .......................XXXXX....
   ...............X................
   ................................
   ................................
   ......XXXXX.......X.............
   ................................
   ................................
   ......................XXXXXXXXXX
   ................................
   ................................
   .........XXXXXXXXXXXX...........
   ................................
   ................................
   XXXXXXX..........XXXX....XXXXXXX
   .........................X......
   .................XXXX....X......
   .........................X......
   .................XXXX....X......
   .........................XXXXXXX
end
   return otherbank

draw_room_shape_5
   playfield:
   ................................
   ................................
   XXX..........................XXX
   ................................
   ........XXXXX............XX.....
   ................................
   ................................
   .......................XX.......
   XXXXXXX.........................
   ................................
   ...........XXXX......XX.........
   ................................
   ................................
   ................................
   ..................XXXX..........
   .......XXXXXX...................
   ................................
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   ................................
   ................................
   ................................
   ................................
   XXXXXXXXXXXXXX..XXXXXX..XXXXXXXX
end
   return otherbank

draw_room_shape_6
   playfield:
   ................................
   ................................
   XXXXXX.....................XXXX.
   ................................
   ..........XXXXXXX...............
   ................................
   ................................
   ................................
   ................XXXXXX..........
   ................................
   ................................
   .........................X......
   ................................
   ................................
   ........................XXXXXXXX
   ................................
   ................................
   XXXXXXXXXXXXXXX.................
   ................................
   .................XX.............
   ..........X.....................
   ................................
   XXXX....XXXXX...........XXXXXXXX
end
   return otherbank

draw_room_shape_7
   playfield:
   ................................
   ................................
   ................................
   ................................
   ................................
   ................XXXXXXXXXXXXXXXX
   ................................
   ................................
   ................................
   XXXXXX..........................
   ................................
   ................................
   .......XX.......................
   ................................
   .............XX.................
   ................................
   ..................XX............
   ................................
   .......................XX.......
   ................................
   ................................
   ................................
   XXXXXXXXX.....XXXXXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_8
   playfield:
   ................................
   ................................
   ................................
   ................................
   ................................
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   ................................
   .......................XXX......
   ................................
   .......................XXX......
   XXXXXXXXXXX.....................
   .......................XXX......
   ................................
   .....X.....XXXXXXX.....XXX......
   .....X..........................
   .....X.................XXX......
   .....X..........................
   .....XXXXXX............XXX......
   .............................XXX
   .......................XXX......
   ................................
   .......................XXX......
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_9
   playfield:
   ......X.........................
   ......X.........................
   ......X.....................X...
   ......X.........................
   ......X....................X....
   XXXXXXX.........................
   ..........................X.....
   ................................
   .........................X......
   ................................
   ......................XX........
   ................................
   ................................
   ............XXXXXXXX............
   ................................
   ................................
   ....XXXXX................XXXXX..
   ................................
   XXXXX...........................
   ................................
   ................................
   ................................
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_10
   playfield:
   ..........................X.....
   ..........................X.....
   ........................XXX.....
   ........................X.......
   ......................XXX.......
   XXXXX............XXXXXX.........
   ....X............X..............
   ....XXX........XXX..............
   ......X.......X.................
   ......XXX...XXX.................
   ........X...X...................
   ........XXXXX.....XXXXXXXXXXXXXX
   ................................
   ..................X.............
   ................................
   .................XX.............
   ................................
   ................XXX..........XXX
   .............................XXX
   ...............XXXX..........XXX
   .............................XXX
   ..............XXXXX..........XXX
   XXXXXXXXXXXXXXXXXXXXXX....XXXXXX
end
   return otherbank

draw_room_shape_11
   playfield:
   ................................
   ................................
   ...............XX...............
   ................................
   ..............X..X..............
   ................................
   ...........X........X...........
   ................................
   ......XXX..............XXX......
   ....XX....................XX....
   ..XX........................XX..
   XX............................XX
   ................................
   ................................
   ...........XXXXXXXXXX...........
   ................................
   ................................
   XX............................XX
   ..XX........................XX..
   ....XX....................XX....
   ......XXX..............XXX......
   ...........XX......XX...........
   .............XXXXXX.............
end
   return otherbank

draw_room_shape_12
   playfield:
   ................................
   ................................
   ................................
   ............................XXXX
   ................................
   ................................
   ...................XXXXXXX......
   ................................
   ..........XXXXXXXX..............
   ......XX........................
   ....X...........................
   XXXX.............X...X..X...X...
   ....XXX..............X..X.......
   .......XXXX..........X..X.......
   ...........X.....X...X..X...X...
   .......XXXX..........X..X.......
   ....XXX..............X..X.......
   XXXX.............X...X..X...X...
   ....X................X..X.....XX
   ......XX.............X..X...XXXX
   ..........XXXXXXXX...X..X...XXXX
   ..................XXXX..XXXXXXXX
   ..............XXXXXXXX..XXXXXXXX
end
   return otherbank

draw_room_shape_13
   playfield:
   ................................
   ................................
   ................................
   XXXXXXXXXXXX.................XXX
   ................................
   ...........................X....
   XXXXXXXXXXXX..XX................
   ..................X..X..X.......
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   XXXXXXXXXXXXXXXXX........XXXXXXX
   XXX......................XXXXXXX
   XXX......................XXXXXXX
   XXX......................XXXXXXX
   XXXX...XXXXXX...X........XXXXXXX
end
   return otherbank


draw_room_shape_14
   playfield:
   ................................
   ................................
   .............XXXXXX.............
   XXXXXXXXXXXX........XXXXXXXXXXXX
   ................................
   ................................
   ................................
   ..............X..X..............
   ................................
   ..........X..........X..........
   .........X............X.........
   .........X............X.........
   ......X..X............X..X......
   .........X............X.........
   .........X............X.........
   .........X............X.........
   ......X..X............X..X......
   .........X............X.........
   X........X............X.........
   XX.......XX..........XX.........
   XXX...X...XXX......XXX...X......
   XXXX............................
   XXXXXXXXX..............XXXXXXXXX
end
   return otherbank


draw_room_shape_15
   playfield:
   ................................
   ......................XX........
   .............XX.................
   XXXXXXXXXX............XX.....XX.
   .............XX.................
   ......................XX........
   .......XX....XX.................
   ......................XX........
   .......XX....XX.................
   ......................XX........
   .......XX....XX.................
   ......................XX........
   .......XX....XX.................
   ......................XX........
   .......XX....XX.................
   ......................XX........
   .......XX....XX.............XXXX
   ................................
   .......XX....XX..XXXX...........
   ........X....X..................
   ........X....X..................
   ........X....X..................
   XXXXXXXXX....XXXXXXXX....XXXXXXX
end
   return otherbank

draw_room_shape_16
   playfield:
   ................................
   ................................
   ................................
   XXXXXXXXXXXXXX.....XXXXXXXXXXXXX
   ................................
   ..............................X.
   ................................
   ................................
   ..............................X.
   ................................
   ................................
   ..............................X.
   ................................
   ................................
   ..............................X.
   ................................
   XXXXXXXXXXXX....................
   ..............................X.
   ................................
   ................................
   ..............................X.
   ................................
   XXXXXXXXXXXXX.........XXXXXXXXXX
end
   return otherbank

draw_room_shape_17
   playfield:
   ................................
   ................................
   .........................XXXXXXX
   XXXXXX..........................
   ................................
   ......XXXXXXXXXXXXX...X.........
   ................................
   ................................
   .........................X......
   ................................
   ................................
   ......................X.........
   ................................
   ........XXXXXXXXXXXXXXXXXXXXXXXX
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ........................X.......
   XXXXXXXXXXXXXXXXXXXXX...XXXXXXXX
end
   return otherbank

draw_room_shape_18
   playfield:
   ................................
   ................................
   ................................
   ................................
   ................................
   XXXXXX..XX......................
   .....X..........................
   .....X......XX..................
   .....X..........................
   .....X..........XX..............
   .....X..........................
   .....X..............XX..........
   .....X..........................
   .....X..................XX......
   .....X..........................
   .....X......................XX..
   .....X..........................
   .....X......................XX..
   .....X..........................
   .....X.................X....XX..
   .....X.................X........
   .....X.................X....XX..
   XXXXXX.................XXXXXXXXX
end
   return otherbank

draw_room_shape_19
   playfield:
   ................................
   ................................
   .............XXXXXX.............
   ................................
   .....................X..........
   .....XXXXXX.....................
   ........................X.......
   ................................
   ..........XXXXX.........X.......
   ................................
   ..................XXXXXXX....X..
   ................................
   ................X............X..
   ................................
   ..............X..............X..
   ................................
   ......XXXXXXX................X..
   ................................
   ....X........................X..
   ................................
   ..X..........................X..
   ............X............X......
   XXXXXXXXXXXXX............XXXXXXX
end
   return otherbank

draw_room_shape_20
   playfield:
   ................................
   ................................
   .................XXXXXX.........
   ................................
   ...............X................
   ................................
   .............X..................
   ................................
   ...........X....................
   ................................
   XXXXXXXXXXXXXXXXXXX...XXXXXXXXXX
   ..................X...X........X
   ..................X...X........X
   .....XXXXX........X...X........X
   ..................X...X........X
   ...........X...................X
   ...............................X
   .............X.................X
   ..................XXXXX........X
   ...............X...............X
   ...............................X
   .................X.....X.......X
   XXXXXXXXXXXXXXXXXX.....XXXXXXXXX
end
   return otherbank

draw_room_shape_21
   playfield:
   ................................
   .............................X..
   ........XXXXXXXXXXXXXXXXXX......
   ................................
   .............................X..
   XXXXX...........................
   ................................
   ....X........................X..
   ................................
   ....X...........................
   XXXXX........................X..
   XXX.............................
   XXX.............................
   XXX..........................X..
   XXX.............................
   XXX.............................
   XXX..........................X..
   XXX.............................
   XXX.............................
   XXX..........................X..
   XXX.............................
   XXX.............................
   XXX..........XXXXXXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_22
   playfield:
   ................................
   ................................
   ..X..X..X..X........X..X..X..X..
   ................................
   ................................
   X..X..X..X..X........X..X..X..X.
   ................................
   ................................
   ..X..X..X..X........X..X..X..X..
   ................................
   ................................
   X..X..X..X..X........X..X..X..X.
   ................................
   ................................
   ..X..X..X..X........X..X..X..X..
   ................................
   ................................
   X..X..X..X..X........X..X..X..X.
   ................................
   ................................
   ..X..X..X..X........X..X..X..X..
   ................................
   XXXXXXXXXX............XXXXXXXXXX
end
   return otherbank

draw_room_shape_23
   playfield:
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ..XXXXX.........................
   ......X.........................
   ..X...X.........................
   ......XXXXX.....................
   ..X.......X.....................
   ..........X.....................
   ..X.......XXXXX.................
   ..............X.................
   ..X...........X.................
   ..............XXXXX.............
   ..X...............X.............
   ..................X.............
   ..X...............XXXXX.........
   ......................X.........
   ..X...................X.........
   XXXXXX................XXXXXXXXXX
end
   return otherbank

draw_room_shape_24
   playfield:
   ...............................X
   ...............................X
   ......................X.....X..X
   .................X.............X
   .............X.................X
   ...........................XXXXX
   .........X.................X...X
   ...........................XXXXX
   ......X....................X...X
   ...........................XXXXX
   ....X......................X...X
   ...........................XXXXX
   ...X.......................X...X
   ...........................XXXXX
   ..X........................X...X
   ...........................XXXXX
   ..X........................X...X
   ...........................XXXXX
   ..X........................X....
   ...........................XX...
   ..X.X...................X.......
   ....X...................X.......
   XXXXX...................XXXXXXXX
end
   return otherbank

draw_room_shape_25
   playfield:
   .................X..............
   .................X..............
   XXXXXXXXXXXXXXXXXX..............
   X...............................
   X...............................
   X...........................XXXX
   X.........................XXX..X
   X...XXXXXXXXXXXXXXXXXXXXXXX....X
   XX.............................X
   X..............................X
   XX.............................X
   X..............................X
   XXXXXXXXXXXXXXXXXXXXXXXXXXXX...X
   X.............................XX
   X..............................X
   X.............................XX
   X..............................X
   XXXXXXXXXXXXXXXX...XXXXXXXXXXXXX
   ..................XX............
   ...................X............
   ..................XX............
   ...................X............
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_26
   playfield:
   ................................
   ................................
   ................................
   ................................
   ................................
   XXXXXXX.........................
   X..X............................
   X..X............................
   XXXX............................
   X..X............................
   X..X...........................
   XXXX............................
   X..X............................
   X..X............................
   XXXX............................
   X..X............................
   X...............................
   XXXXXXXXXXXXXXXXXXXXXXXX..XXXXXX
   ................................
   ................................
   ................................
   ................................
   XXXXXXXXXXXXXXXXXXXXX...XXXXXXXX
end
   return otherbank

draw_room_shape_27
   playfield:
   ................................
   ................................
   XX...XXXXX............XXXXX...XX
   ................................
   ................................
   XX............................XX
   ................................
   ................................
   XX............................XX
   ................................
   ................................
   XX............................XX
   ................................
   ................................
   XX............................XX
   ................................
   ................................
   XXXXXXXXXX..X.....XXXXXXXXXXXXXX
   ...........XXX..................
   ............X...................
   ...........XXX..................
   ............X...................
   XXXXXXXXXXXXX.....XXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_28
   playfield:
   ................................
   ................................
   ................................
   ................................
   ....XXXXXXXXXXXXX...XXXXXXXX....
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ................................
   ......XXXXXXXXX.......XXXX......
   ................................
   ................................
   ................................
   ....XXXXXXXXXXXXX...XXXXXXXX....
   ................................
   ................................
   ................................
   ................................
   ........................X.......
   XXXXXXXXXXXXXXXXXXXXX...XXXXXXXX
end
   return otherbank

draw_room_shape_29
   playfield:
   ................................
   ................................
   ................................
   ..............XXXX..............
   ................................
   ................................
   ..............XXXX..............
   ................................
   ................................
   ..............XXXX..............
   ................................
   ................................
   ..............XXXX..............
   ................................
   ..........XXXX....XXXX..........
   ................................
   .......XXX............XXX.......
   ................................
   ....XX.......X....X.......XX....
   .............X....X.............
   ..XX.........X....X.........XX..
   .............X....X.............
   XXXXXXXXXXXXXX....XXXXXXXXXXXXXX
end
   return otherbank


draw_room_shape_30
   playfield:
   .....x......X..................X
   .....x......X..................X
   .....X......X..................X
   .....X......X......X...........X
   .....X......X......X...........X
   .....X......XXX....X...........X
   .....XXX....X......X...........X
   .....X......X......X...........X
   .....X......X....XXX...........X
   .....X....XXX......X...XXXX....X
   .....X......X......X..XXXXXX...X
   .....X......XXX....X.XX....XX..X
   .....XXX....X......X.XX....XX..X
   .....X......X......X.XX....XX..X
   .....X......X....XXX.XX....XX..X
   .....X......X......XXXXXXX.....X
   .....X....XXX......XXXXXXXXXXXXX
   .....X......X......XXXXXXXXXXXXX
   .....X......XXX....X...........X
   .....XXX...........X...........X
   .....X.............X...........X
   .....X.............X...........X
   XXXXXX......X....XXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_30_final
   playfield:
   ............X..................X
   ............X..................X
   .....X......X..................X
   .....X......X......X...........X
   ...XXX......X......X...........X
   .....X......XXX....X...........X
   .....XXX....X......X...........X
   .X...X......X......X...........X
   .....X......X....XXX...........X
   .....X....XXX......X...XXXX....X
   ...XXX......X......X..XXXXXX...X
   .....X......XXX....X.XX....XX..X
   .....XXX....X......X.XX....XX..X
   .X...X......X......X.XX....XX..X
   .....X......X....XXX.XX....XX..X
   .....X......X......XXXXXXX.....X
   ...XXX....XXX......XXXXXXXXXXXXX
   .....X......X......XXXXXXXXXXXXX
   .....X......XXX....X...........X
   .X...XXX...........X...........X
   .....X............XX...........X
   .....X.........................X
   XXXXXX......X....XXXXXXXXXXXXXXX
end
   return otherbank

draw_room_shape_31
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   X..............................X
   X..............................X
   X..............................X
   X..............................X
   X..............................X
   X..XXXXXXX.....................X
   X..............................X
   X..............................X
   X......................XXXX....X
   X..XX.................XXXXXX...X
   X..XXXXXXX...........XX....XX..X
   X....................XX....XX..X
   X.....X..............XX....XX..X
   X....................XX....XX..X
   X.....X..................XXXX..X
   X..................XXXXXXXXXXXXX
   X.....X............XXXXXXXXXXXXX
   X..................XXXXXXXXXXXXX
   X.....X.................XX.....X
   X......................XXXX....X
   X.....X..............XXXXXXXX..X
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
end
   return otherbank

secret
   playfield:
   ................................
   .XXXXX.XXXXX.XXXXX.X...X.XXXXX..
   .X.......X...X.....X...X.X......
   .XXXXX...X...XXX...X...X.XXX....
   .....X...X...X......X.X..X......
   .XXXXX...X...XXXXX...X...XXXXX..
   ................................
   X....XXXXX.....................X
   X....X.........................X
   X....XXX.......................X
   X....X.........................X
   X....XXXXX.X...................X
   X..............................X
   X.XXXXX.XXXXX.X.XXXXX..........X
   X.....X.X...X.X.....X..XXXX....X
   X.XXXXX.X...X.X.XXXXX...........
   X.X.....X...X.X.X...............
   X.XXXXX.XXXXX.X.XXXXX......XXXXX
   X..............................X
   X..............................X
   X......................XXXX....X
   X..............................X
   XXXXXXXXXXXXXX....XXXXXXXXXXXXXX
end
   return otherbank

 bank 4

explode

 AUDV1=0:AUDV0=0

 NUSIZ0=$10
 NUSIZ1=$10

 goto skipthis
 player0:
 %00000000
end
 player1:
 %00000000
end
skipthis

explode2

 NUSIZ0=$10
 NUSIZ1=$10

 if l<41 then AUDF0=31:AUDC0=8:AUDV0=9 else AUDV0=0

   l=l+1
   drawscreen

   if switchreset then reboot

   if m{1} then goto explode

   if l>41 && score3=$00 then COLUPF=02:m{1}=1:goto explode

   if ypos>89 then goto skip1
   if g = 0 && l>35 && score3>$00 then COLUPF=144:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_0 bank3
   if g = 1 && l>35 && score3>$00 then COLUPF=146:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_1 bank3
   if g = 2 && l>35 && score3>$00 then COLUPF=148:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_2 bank3
   if g = 3 && l>35 && score3>$00 then COLUPF=150:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_3 bank3
   if g = 4 && l>35 && score3>$00 then COLUPF=152:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_4 bank3
   if g = 5 && l>35 && score3>$00 then COLUPF=156:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_5 bank3
   if g = 6 && l>35 && score3>$00 then COLUPF=158:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_6 bank3
   if g = 7 && l>35 && score3>$00 then COLUPF=160:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_7 bank3
   if g = 8 && l>35 && score3>$00 then COLUPF=162:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_8 bank3
   if g = 9 && l>35 && score3>$00 then COLUPF=164:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_9 bank3
   if g = 10 && l>35 && score3>$00 then COLUPF=166:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_10 bank3
   if g = 11 && l>35 && score3>$00 then COLUPF=168:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_11 bank3
   if g = 12 && l>35 && score3>$00 then COLUPF=170:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_12 bank3
   if g = 13 && l>35 && score3>$00 then COLUPF=172:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_13 bank3
   if g = 14 && l>35 && score3>$00 then COLUPF=194:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_14 bank3
   if g = 15 && l>35 && score3>$00 then COLUPF=196:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_15 bank3
   if g = 16 && l>35 && score3>$00 then COLUPF=198:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_16 bank3
   if g = 17 && l>35 && score3>$00 then COLUPF=200:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_17 bank3
   if g = 18 && l>35 && score3>$00 then COLUPF=202:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_18 bank3
   if g = 19 && l>35 && score3>$00 then COLUPF=204:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_19 bank3
   if g = 20 && l>35 && score3>$00 then COLUPF=206:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_20 bank3
   if g = 21 && l>35 && score3>$00 then COLUPF=210:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_21 bank3
   if g = 22 && l>35 && score3>$00 then COLUPF=212:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_22 bank3
   if g = 23 && l>35 && score3>$00 then COLUPF=214:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_23 bank3
   if g = 24 && l>35 && score3>$00 then COLUPF=216:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_24 bank3
   if g = 25 && l>35 && score3>$00 then COLUPF=218:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_25 bank3
   if g = 26 && l>35 && score3>$00 then COLUPF=48:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_26 bank3
   if g = 27 && l>35 && score3>$00 then COLUPF=50:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_27 bank3
   if g = 28 && l>35 && score3>$00 then COLUPF=52:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_28 bank3
   if g = 29 && l>35 && score3>$00 then COLUPF=54:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_29 bank3
   if g = 30 && l>35 && score3>$00 then COLUPF=190:player1x=player0x-35:player1y=player0y+25:goto draw_room_shape_30 bank3
skip1

   rem
   rem following section is only for when you've fallen past the bottom of the screen.
   rem I've commented out the screens that don't have any "pits" in them.
   rem
   if ypos<90 then goto skip2
   if g = 0 && l>35 && score3>$00 then COLUPF=144:ypos=20.0:player0x=30:goto draw_room_shape_0 bank3
   if g = 1 && l>35 && score3>$00 then COLUPF=146:ypos=20.0:player0x=30:goto draw_room_shape_1 bank3
   if g = 2 && l>35 && score3>$00 then COLUPF=148:ypos=20.0:player0x=30:goto draw_room_shape_2 bank3
   if g = 3 && l>35 && score3>$00 then COLUPF=150:ypos=20.0:player0x=81:goto draw_room_shape_3 bank3
   if g = 4 && l>35 && score3>$00 then COLUPF=152:ypos=20.0:player0x=30:goto draw_room_shape_4 bank3
   if g = 5 && l>35 && score3>$00 then COLUPF=156:ypos=20.0:player0x=30:goto draw_room_shape_5 bank3
   if g = 6 && l>35 && score3>$00 then COLUPF=158:ypos=20.0:player0x=30:goto draw_room_shape_6 bank3
   if g = 7 && l>35 && score3>$00 then COLUPF=160:ypos=20.0:player0x=30:goto draw_room_shape_7 bank3
   rem if g = 8 && l>35 && score3>$00 then COLUPF=162:ypos=20.0:player0x=30:goto draw_room_shape_8 bank3
   rem if g = 9 && l>35 && score3>$00 then COLUPF=164:ypos=20.0:player0x=30:goto draw_room_shape_9 bank3
   if g = 10 && l>35 && score3>$00 then COLUPF=166:ypos=20.0:player0x=30:goto draw_room_shape_10 bank3
   if g = 11 && l>35 && score3>$00 then COLUPF=168:ypos=20.0:player0x=30:goto draw_room_shape_11 bank3
   if g = 12 && l>35 && score3>$00 then COLUPF=170:ypos=20.0:player0x=30:goto draw_room_shape_12 bank3
   if g = 13 && l>35 && score3>$00 then COLUPF=172:ypos=20.0:player0x=30:goto draw_room_shape_13 bank3
   if g = 14 && l>35 && score3>$00 then COLUPF=194:ypos=20.0:player0x=30:goto draw_room_shape_14 bank3
   if g = 15 && l>35 && score3>$00 then COLUPF=196:ypos=20.0:player0x=30:goto draw_room_shape_15 bank3
   if g = 16 && l>35 && score3>$00 then COLUPF=198:ypos=20.0:player0x=30:goto draw_room_shape_16 bank3
   if g = 17 && l>35 && score3>$00 then COLUPF=200:ypos=20.0:player0x=30:goto draw_room_shape_17 bank3
   if g = 18 && l>35 && score3>$00 then COLUPF=202:ypos=20.0:player0x=30:goto draw_room_shape_18 bank3
   if g = 19 && l>35 && score3>$00 then COLUPF=204:ypos=20.0:player0x=30:goto draw_room_shape_19 bank3
   if g = 20 && l>35 && score3>$00 then COLUPF=206:ypos=20.0:player0x=30:goto draw_room_shape_20 bank3
   if g = 21 && l>35 && score3>$00 then COLUPF=210:ypos=20.0:player0x=30:goto draw_room_shape_21 bank3
   if g = 22 && l>35 && score3>$00 then COLUPF=212:ypos=20.0:player0x=30:goto draw_room_shape_22 bank3
   if g = 23 && l>35 && score3>$00 then COLUPF=214:ypos=20.0:player0x=30:goto draw_room_shape_23 bank3
   if g = 24 && l>35 && score3>$00 then COLUPF=216:ypos=20.0:player0x=30:goto draw_room_shape_24 bank3
   rem if g = 25 && l>35 && score3>$00 then COLUPF=218:ypos=20.0:player0x=30:goto draw_room_shape_25 bank3
   if g = 26 && l>35 && score3>$00 then COLUPF=48:ypos=20.0:player0x=30:goto draw_room_shape_26 bank3
   if g = 27 && l>35 && score3>$00 then COLUPF=50:ypos=20.0:player0x=30:goto draw_room_shape_27 bank3
   if g = 28 && l>35 && score3>$00 then COLUPF=52:ypos=20.0:player0x=30:goto draw_room_shape_28 bank3
   if g = 29 && l>35 && score3>$00 then COLUPF=54:ypos=20.0:player0x=30:goto draw_room_shape_29 bank3
   if g = 30 && l>35 && score3>$00 then COLUPF=190:ypos=20.0:player0x=30:goto draw_room_shape_30 bank3
skip2

   COLUPF=l

 if l=5 then player0:
 %00000000
 %00000000
 %00010000
 %00111000
 %00111000
 %00010000
 %00000000
 %00000000
end

 if l=10 then player0:
 %00000000
 %00010000
 %01000100
 %00001000
 %10100000
 %01000100
 %00010000
 %00000000
end

 if l=15 then player0:
 %00001000
 %01000000
 %00000001
 %00010100
 %10101000
 %00000100
 %01000001
 %00001000
end
 
 if l=20 then player0:
 %10001000
 %00000001
 %00010100
 %00000001
 %10100000
 %00010100
 %00000001
 %10010100
end

 if l=25 then player0:
 %10001001
 %01010100
 %00000010
 %01000001
 %10000010
 %00100000
 %01001010
 %10010001
end
 
 if l=30 then player0:
 %01010010
 %00001000
 %00000001
 %10000010
 %00000000
 %01000000
 %00000001
 %01001000
end

 if l=35 then player0:
 %01000010
 %00000001
 %10000000
 %00000000
 %00000000
 %00000000
 %00000000
 %10000001
end
 drawscreen

 if l=41 then player0:
 %00000000
end
 drawscreen
   goto explode2
  
 bank 5

 rem
 rem treasure & barrier placement for each room
 rem  Room 30 & 31 were moved to bank 1, I ran out of space in bank 5.

Room_0
 if !var5{0} then missile0x=47:missile0y=68 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{0}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{0} then missile1x=115:missile1y=5 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{0}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=var27:bally=87
 return otherbank

Room_1
 if !var5{1} then missile0x=59:missile0y=12 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{1}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{1} then missile1x=130:missile1y=68 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{1}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_2
 if !var5{2} then missile0x=r:missile0y=10 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{2}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{2} then missile1x=35:missile1y=81 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{2}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_3
 if !var5{3} then missile0x=125:missile0y=5 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{3}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{3} then missile1x=39:missile1y=11 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{3}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=48:bally=var27-65
 return otherbank

Room_4
 if !var5{4} then missile0x=125:missile0y=81 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{4}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{4} then missile1x=46:missile1y=28 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{4}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=var27:bally=55
 return otherbank

Room_5
 if !var5{5} then missile0x=r+10:missile0y=6 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{5}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{5} then missile1x=20:missile1y=78 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{5}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_6
 if !var5{6} then missile0x=47:missile0y=12 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{6}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{6} then missile1x=135:missile1y=78 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{6}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_7
 if !var5{7} then missile0x=86:missile0y=29 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var5{7}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var9{7} then missile1x=120:missile1y=18 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var9{7}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_8
 if !var6{0} then missile0x=48:missile0y=60 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{0}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var10{0} then missile1x=120:missile1y=18 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{0}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_9
 if !var6{1} then missile0x=29:missile0y=12 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{1}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var10{1} then missile1x=109:missile1y=38 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{1}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_10
 if !var6{2} then missile0x=70:missile0y=34 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{2}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var10{2} then missile1x=110:missile1y=15 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{2}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_11
 if !var6{3} then missile0x=81:missile0y=52 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{3}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var10{3} then missile1x=81:missile1y=6 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{3}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=var27:bally=55
 return otherbank

Room_12
 if !var6{4} then missile0x=20:missile0y=62 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{4}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var10{4} then missile1x=109:missile1y=s else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{4}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=0:bally=0
 return otherbank

Room_13
 if !var6{5} then missile0x=r:missile0y=78 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{5}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0:AUDF0=1:AUDC0=2:AUDV0=15
 if !var10{5} then missile1x=120:missile1y=18 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{5}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0:AUDF0=1:AUDC0=2:AUDV0=15
 ballx=var27+22:bally=27
 return otherbank

Room_14
 if !var6{6} then missile0x=67:missile0y=s-9 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{6}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var10{6} then missile1x=95:missile1y=s-9 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{6}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_15
 if !var6{7} then missile0x=61:missile0y=s+5 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var6{7}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var10{7} then missile1x=124:missile1y=6 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var10{7}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_16
 if !var7{0} then missile0x=80:missile0y=40 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var7{0}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{0} then missile1x=94:missile1y=40 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{0}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_17
 if !var7{1} then missile0x=r+20:missile0y=59 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var7{1}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{1} then missile1x=132:missile1y=18 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{1}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=var27:bally=87
 return otherbank

Room_18
 if !var7{2} then missile0x=106:missile0y=10 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var7{2}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{2} then missile1x=29:missile1y=58 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{2}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_19
 if !var7{3} then missile0x=25:missile0y=12 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var7{3}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{3} then missile1x=135:missile1y=6 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{3}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=77:bally=31
 return otherbank

Room_20
 if !var7{4} then missile0x=125:missile0y=12 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var7{4}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{4} then missile1x=38:missile1y=49 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{4}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_21
 if !var7{5} then missile0x=62:missile0y=r+20 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var7{5}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{5} then missile1x=s-14:missile1y=r+20 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{5}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=var27+8:bally=87
 return otherbank

Room_22
 if k>1 then skip8
 if !var7{6} then missile0x=r+k:missile0y=s-k-30 else missile0x=0:missile0y=0
skip8
 if collision(player0,missile0) then var7{6}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{6} then missile1x=81:missile1y=s-40 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{6}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=83:bally=s
 return otherbank

Room_23
 if !var7{7} then missile0x=135:missile0y=s-27 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var7{7}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var11{7} then missile1x=r+36:missile1y=8 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var11{7}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_24
 if !var8{0} then missile0x=110:missile0y=40 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var8{0}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var12{0} then missile1x=131:missile1y=6 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var12{0}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_25
 if !var8{1} then missile0x=105:missile0y=78 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var8{1}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var12{1} then missile1x=131:missile1y=18 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var12{1}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=var27+25:bally=47
 return otherbank

Room_26
 if !var8{2} then missile0x=r+40:missile0y=8 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var8{2}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var12{2} then missile1x=135:missile1y=76 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var12{2}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=var27:bally=87
 return otherbank

Room_27
 if !var8{3} then missile0x=80:missile0y=40 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var8{3}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var12{3} then missile1x=120:missile1y=78 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var12{3}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

Room_28
 if !var8{4} then missile0x=80:missile0y=40 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var8{4}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var12{4} then missile1x=120:missile1y=12 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var12{4}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=var27:bally=87
 return otherbank

Room_29
 if !var8{5} then missile0x=122:missile0y=30 else missile0x=0:missile0y=0
 if collision(player0,missile0) then var8{5}=1:score=score+10000:var14=var14+1:missile0x=0:missile0y=0
 if !var12{5} then missile1x=45:missile1y=30 else missile1x=0:missile1y=0
 if collision(player0,missile1) then var12{5}=1:score=score+10000:var14=var14+1:missile1x=0:missile1y=0
 ballx=0:bally=0
 return otherbank

 bank 6

 rem
 rem  Map Screen
 rem    
 rem

map

 ballx=0:bally=0

 player0:
 %00000000
 %00000000
end


 player1:
 %11111111
 %11111111
 %11111111
 %11100111
 %11100111
 %11111111
 %11111111
 %11111111
end

map2

 if switchreset then reboot

 COLUP1=66
 COLUP0=254

 var16=var16+1
 if var16>30 then var16=0

   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   X...X...X...X...X...X...X...X...
   X...X...X...X...X...X...X...X...
   X...X...X...X...X...X...X...X...
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   ................................
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ...X...X...X...X...X...X...X....
   ...X...X...X...X...X...X...X....
   ...X...X...X...X...X...X...X....
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ...X...X...X...X...X...X...X....
   ...X...X...X...X...X...X...X....
   ...X...X...X...X...X...X...X....
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXXXXXXXXXXXXXXXXXXXXXXXXXXX....
   ...X...X...X...X...X...X...X....
   ...X...X...X...X...X...X...X....
   ...X...X...X...X...X...X...X....
   XXXXXXXXXXXXXXXXXXXXXXXXXXXX....
end

 drawscreen

 rem
 rem The map screen will only show you the remaining treasures for the "row" of the map that you're on.
 rem
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
 rem   X...X...X...X...X...X...X...X...
 rem   X.0.X.1.X.2.X.3.X.4.X.5.X.6.X.7.  <--- Row 1
 rem   X...X...X...X...X...X...X...X...
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
 rem   ................................
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
 rem   ...X...X...X...X...X...X...X....
 rem   .8.X.9.X.10X.11X.12X.13X.14X.15.  <--- Row 2
 rem   ...X...X...X...X...X...X...X....
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
 rem   ................................
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
 rem   ...X...X...X...X...X...X...X....
 rem   .16X.17X.18X.19X.20X.21X.22X.23.  <--- Row 3
 rem   ...X...X...X...X...X...X...X....
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
 rem   ................................
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXX....
 rem   ...X...X...X...X...X...X...X....
 rem   .24X.25X.26X.27X.28X.29X.30X....  <--- Row 4
 rem   ...X...X...X...X...X...X...X....
 rem   XXXXXXXXXXXXXXXXXXXXXXXXXXXX....

 if g<8 then goto Show_0_7
 if g>7 && g<16 then goto Show_8_15
 if g>15 && g<24 then goto Show_16_23
 if g>23 then goto Show_24_30

 goto map2

Show_0_7
 rem
 rem this section marks the map with your current location
 rem
 if g=0 then player1x=23:player1y=14
 if g=1 then player1x=39:player1y=14
 if g=2 then player1x=55:player1y=14
 if g=3 then player1x=71:player1y=14
 if g=4 then player1x=87:player1y=14
 if g=5 then player1x=103:player1y=14
 if g=6 then player1x=119:player1y=14
 if g=7 then player1x=135:player1y=14
 rem
 rem This section returns you to the same position you were in when you entered the map screen
 rem
 if !switchbw && g=0 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_0 bank3
 if !switchbw && g=1 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_1 bank3
 if !switchbw && g=2 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_2 bank3
 if !switchbw && g=3 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_3 bank3
 if !switchbw && g=4 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_4 bank3
 if !switchbw && g=5 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_5 bank3
 if !switchbw && g=6 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_6 bank3
 if !switchbw && g=7 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_7 bank3
 rem
 rem This section puts a dot on the screen for every treasure that hasn't been picked up yet.
 rem
 if !var5{0} && var16=0 then missile0x=22:missile0y=14
 if !var5{1} && var16=1 then missile0x=38:missile0y=14 
 if !var5{2} && var16=2 then missile0x=54:missile0y=14 
 if !var5{3} && var16=3 then missile0x=70:missile0y=14 
 if !var5{4} && var16=4 then missile0x=86:missile0y=14   
 if !var5{5} && var16=5 then missile0x=102:missile0y=14  
 if !var5{6} && var16=6 then missile0x=118:missile0y=14  
 if !var5{7} && var16=7 then missile0x=134:missile0y=14  
 if !var9{0} && var16=0 then missile1x=33:missile1y=14
 if !var9{1} && var16=1 then missile1x=49:missile1y=14 
 if !var9{2} && var16=2 then missile1x=65:missile1y=14 
 if !var9{3} && var16=3 then missile1x=81:missile1y=14 
 if !var9{4} && var16=4 then missile1x=97:missile1y=14   
 if !var9{5} && var16=5 then missile1x=113:missile1y=14  
 if !var9{6} && var16=6 then missile1x=129:missile1y=14  
 if !var9{7} && var16=7 then missile1x=145:missile1y=14 
 goto map2

Show_8_15
 rem
 rem this section marks the map with your current location
 rem
 if g=8 then player1x=19:player1y=38
 if g=9 then player1x=35:player1y=38
 if g=10 then player1x=51:player1y=38
 if g=11 then player1x=67:player1y=38
 if g=12 then player1x=83:player1y=38
 if g=13 then player1x=99:player1y=38
 if g=14 then player1x=115:player1y=38
 if g=15 then player1x=131:player1y=38
 rem
 rem This section returns you to the same position you were in when you entered the map screen
 rem
 if !switchbw && g=8 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_8 bank3
 if !switchbw && g=9 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_9 bank3
 if !switchbw && g=10 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_10 bank3
 if !switchbw && g=11 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_11 bank3
 if !switchbw && g=12 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_12 bank3
 if !switchbw && g=13 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_13 bank3
 if !switchbw && g=14 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_14 bank3
 if !switchbw && g=15 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_15 bank3
 rem
 rem This section puts a dot on the screen for every treasure that hasn't been picked up yet.
 rem
 if !var6{0} && var16=8 then missile0x=18:missile0y=38  
 if !var6{1} && var16=9 then missile0x=34:missile0y=38   
 if !var6{2} && var16=10 then missile0x=50:missile0y=38   
 if !var6{3} && var16=11 then missile0x=66:missile0y=38  
 if !var6{4} && var16=12 then missile0x=82:missile0y=38  
 if !var6{5} && var16=13 then missile0x=98:missile0y=38  
 if !var6{6} && var16=14 then missile0x=114:missile0y=38  
 if !var6{7} && var16=15 then missile0x=130:missile0y=38
 if !var10{0} && var16=8 then missile1x=29:missile1y=38 
 if !var10{1} && var16=9 then missile1x=45:missile1y=38   
 if !var10{2} && var16=10 then missile1x=61:missile1y=38   
 if !var10{3} && var16=11 then missile1x=77:missile1y=38  
 if !var10{4} && var16=12 then missile1x=93:missile1y=38  
 if !var10{5} && var16=13 then missile1x=109:missile1y=38  
 if !var10{6} && var16=14 then missile1x=125:missile1y=38  
 if !var10{7} && var16=15 then missile1x=141:missile1y=38  
 goto map2

Show_16_23
 rem
 rem this section marks the map with your current location
 rem
 if g=16 then player1x=19:player1y=62
 if g=17 then player1x=35:player1y=62
 if g=18 then player1x=51:player1y=62
 if g=19 then player1x=67:player1y=62
 if g=20 then player1x=83:player1y=62
 if g=21 then player1x=99:player1y=62
 if g=22 then player1x=115:player1y=62
 if g=23 then player1x=131:player1y=62
 rem
 rem This section returns you to the same position you were in when you entered the map screen
 rem
 if !switchbw && g=16 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_16 bank3
 if !switchbw && g=17 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_17 bank3
 if !switchbw && g=18 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_18 bank3
 if !switchbw && g=19 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_19 bank3
 if !switchbw && g=20 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_20 bank3
 if !switchbw && g=21 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_21 bank3
 if !switchbw && g=22 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_22 bank3
 if !switchbw && g=23 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_23 bank3
 rem
 rem This section puts a dot on the screen for every treasure that hasn't been picked up yet.
 rem
 if !var7{0} && var16=16 then missile0x=18:missile0y=62  
 if !var7{1} && var16=17 then missile0x=34:missile0y=62  
 if !var7{2} && var16=18 then missile0x=50:missile0y=62  
 if !var7{3} && var16=19 then missile0x=66:missile0y=62  
 if !var7{4} && var16=20 then missile0x=82:missile0y=62  
 if !var7{5} && var16=21 then missile0x=98:missile0y=62  
 if !var7{6} && var16=22 then missile0x=114:missile0y=62  
 if !var7{7} && var16=23 then missile0x=130:missile0y=62  
 if !var11{0} && var16=16 then missile1x=29:missile1y=62  
 if !var11{1} && var16=17 then missile1x=45:missile1y=62  
 if !var11{2} && var16=18 then missile1x=61:missile1y=62  
 if !var11{3} && var16=19 then missile1x=77:missile1y=62  
 if !var11{4} && var16=20 then missile1x=93:missile1y=62  
 if !var11{5} && var16=21 then missile1x=109:missile1y=62  
 if !var11{6} && var16=22 then missile1x=125:missile1y=62  
 if !var11{7} && var16=23 then missile1x=141:missile1y=62 
 goto map2

Show_24_30
 rem
 rem this section marks the map with your current location
 rem
 if g=24 then player1x=19:player1y=86
 if g=25 then player1x=35:player1y=86
 if g=26 then player1x=51:player1y=86
 if g=27 then player1x=67:player1y=86
 if g=28 then player1x=83:player1y=86
 if g=29 then player1x=99:player1y=86
 if g=30 then player1x=115:player1y=86
 rem
 rem This section returns you to the same position you were in when you entered the map screen
 rem
 if !switchbw && g=24 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_24 bank3
 if !switchbw && g=25 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_25 bank3
 if !switchbw && g=26 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_26 bank3
 if !switchbw && g=27 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_27 bank3
 if !switchbw && g=28 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_28 bank3
 if !switchbw && g=29 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_29 bank3
 if !switchbw && g=30 then player0x=var1:player0y=var2:player1y=var1+40:goto draw_room_shape_30 bank3
 rem
 rem This section puts a dot on the screen for every treasure that hasn't been picked up yet.
 rem
 if !var8{0} && var16=24 then missile0x=18:missile0y=86  
 if !var8{1} && var16=25 then missile0x=34:missile0y=86  
 if !var8{2} && var16=26 then missile0x=50:missile0y=86  
 if !var8{3} && var16=27 then missile0x=66:missile0y=86  
 if !var8{4} && var16=28 then missile0x=82:missile0y=86   
 if !var8{5} && var16=29 then missile0x=98:missile0y=86  
 if !var8{6} && var16=30 then missile0x=114:missile0y=86
 if !var12{0} && var16=24 then missile1x=29:missile1y=86  
 if !var12{1} && var16=25 then missile1x=45:missile1y=86  
 if !var12{2} && var16=26 then missile1x=61:missile1y=86  
 if !var12{3} && var16=27 then missile1x=77:missile1y=86  
 if !var12{4} && var16=28 then missile1x=93:missile1y=86   
 if !var12{5} && var16=29 then missile1x=109:missile1y=86  
 if !var12{6} && var16=30 then missile1x=125:missile1y=86 
 goto map2

 bank 7

titlestart

   AUDV0=0
   AUDV1=0
   duration = 1
   goto MusicSetup

title

 dim rseed=rand

 gosub titledrawscreen

 u=u+1:if u=0 then u=1
 if joy0fire || switchreset then AUDV0=0:AUDV1=0:rseed=u:goto opt bank8

 goto GetMusic

GotMusic


 goto title

 asm
 include "titlescreen/asm/titlescreen.asm"
end

GetMusic

   rem  *  Check for end of current note
   duration = duration - 1
   if duration>0 then GotMusic


   rem  *  Retrieve channel 0 data
   temp4 = sread(musicData)
   temp5 = sread(musicData)
   temp6 = sread(musicData)


   rem  *  Check for end of data
   if temp4=255 then duration = 1 : goto MusicSetup


   rem  *  Play channel 0
   AUDV0 = temp4
   AUDC0 = temp5
   AUDF0 = temp6


   rem  *  Retrieve channel 1 data
   temp4 = sread(musicData)
   temp5 = sread(musicData)
   temp6 = sread(musicData)


   rem  *  Play channel 1
   AUDV1 = temp4
   AUDC1 = temp5
   AUDF1 = temp6


   rem  *  Set duration
   duration = sread(musicData)
   goto GotMusic


MusicSetup
   sdata musicData=x
  8,4,19
  0,0,0
  9
  2,4,19
  0,0,0
  8
  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8
  8,4,23
  0,0,0
  38
  2,4,23
  0,0,0
  8

  8,4,19
  0,0,0
  9
  2,4,19
  0,0,0
  8
  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8
  8,4,23
  0,0,0
  38
  2,4,23
  0,0,0
  8

  8,4,19
  0,0,0
  9
  2,4,19
  0,0,0
  8
  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8
  8,4,23
  0,0,0
  38
  2,4,23
  0,0,0
  8

  8,4,19
  0,0,0
  9
  2,4,19
  0,0,0
  8
  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8
  8,4,23
  0,0,0
  38
  2,4,23
  0,0,0
  8



  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8
  8,4,23
  0,0,0
  15
  2,4,23
  0,0,0
  8
  8,4,23
  0,0,0
  11
  8,4,26
  0,0,0
  38
  2,4,26
  0,0,0
  8


  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8
  8,4,23
  0,0,0
  15
  2,4,23
  0,0,0
  8
  8,4,23
  0,0,0
  11
  8,4,26
  0,0,0
  38
  2,4,26
  0,0,0
  8




  8,4,19
  0,0,0
  32
  2,4,19
  0,0,0
  8

  8,4,23
  0,0,0
  15
  2,4,23
  0,0,0
  8

  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8

  8,4,29
  0,0,0
  49
  2,4,29
  0,0,0
  8

  8,4,29
  0,0,0
  43
  2,4,29
  0,0,0
  8

  8,4,19
  0,0,0
  32
  2,4,19
  0,0,0
  8

  8,4,23
  0,0,0
  15
  2,4,23
  0,0,0
  8

  8,4,26
  0,0,0
  9
  2,4,26
  0,0,0
  8

  8,4,29
  0,0,0
  49
  2,4,29
  0,0,0
  8

  8,4,29
  0,0,0
  43
  2,4,29
  0,0,0
  8

  8,4,17
  0,0,0
  9
  2,4,17
  0,0,0
  8
  8,4,15
  0,0,0
  9
  2,4,15
  0,0,0
  8
  8,4,14
  0,0,0
  32
  2,4,14
  0,0,0
  8
  8,4,14
  0,0,0
  11
  8,4,15
  0,0,0
  11
  8,4,17
  0,0,0
  9
  2,4,17
  0,0,0
  8
  8,4,19
  0,0,0
  38
  2,4,19
  0,0,0
  8


  8,4,17
  0,0,0
  9
  2,4,17
  0,0,0
  8
  8,4,15
  0,0,0
  9
  2,4,15
  0,0,0
  8
  8,4,14
  0,0,0
  32
  2,4,14
  0,0,0
  8
  8,4,14
  0,0,0
  11
  8,4,15
  0,0,0
  11
  8,4,17
  0,0,0
  9
  2,4,17
  0,0,0
  8
  8,4,19
  0,0,0
  38
  2,4,19
  0,0,0
  8
 
  255
end
   goto GotMusic


 bank 8

finalscreen
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   X..............................X
   X..............................X
   X..............................X
   X..............................X
   X..............................X
   X..XXXXXXX.....................X
   X..............................X
   X..............................X
   X......................XXXX....X
   X..XX.................XXXXXX...X
   X..XXXXXXX...........XX....XX..X
   X....................XX....XX..X
   X.....X..............XX....XX..X
   X....................XX....XX..X
   X.....X..................XXXX..X
   X..................XXXXXXXXXXXXX
   X.....X............XXXXXXXXXXXXX
   X..................XXXXXXXXXXXXX
   X.....X.................XX.....X
   X......................XXXX....X
   X.....X..............XXXXXXXX..X
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
end
 return otherbank

opt
 COLUPF=148
 COLUP1=28
 COLUP0=148
 var40=0
 var37=1
  missile0x=0:missile0y=0
  missile1x=0:missile1y=0

   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXX.X.X...X...X...X...X...XXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XX...X...X...X.X...X.XXX.X...XX.
   XX.X.X.X.XX.XX.X.X.X..XX.X.XXXX.
   XX.X.X...XX.XX.X.X.X.X.X.X...XX.
   XX.X.X.XXXX.XX.X.X.X.XX..XXX.XX.
   XX...X.XXXX.XX.X...X.XXX.X...XX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XX..XXX.XXX.....................
   X.X.X.X..X......................
   XXX.XXX..X......................
   X.X.X.X..X......................
   XX..X.X..X......................
   ................................
   XXX.XXX.XXX.XXX.XX...........XX.
   X...X.X.X...X...X.X.........X..X
   XXX.XXX.XXX.XXX.X.X.........X..X
   ..X.X...X...X...X.X.........X..X
   XXX.X...XXX.XXX.XX...........XX.
end
  
 var35{0}=0: rem speed high if on
 var35{1}=1: rem speed low if on

 var35{2}=1: rem god mode off if on
 var35{3}=0: rem god mode on if on

 var35{4}=1: rem high gravity high if on
 var35{5}=0: rem high gravity low if on

 var35{6}=0: rem velocity high if on
 var35{7}=1: rem velocity low if on

 var41{0}=0: rem player speed high if on
 var41{1}=1: rem player speed low if on

 var41{2}=1: rem random start is off (if 1)
 var41{3}=0: rem random start is on  (if 1)
 
 player1:
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
 %11111111
end

opt2

 COLUP0=8
 COLUP1=148
 NUSIZ1=$05

 rem ballheight=70
 rem ballx=18:bally=62
 rem missile1height=70
 rem missile1x=145:missile1y=62

 player1x=128:player1y=90

 if switchreset then reboot

 rem normal game mode: def GRAVITY=0.05
 rem normal game mode: def JUMPVELOCITY=1.2


  if var35{0} && var37=1 then gosub high: player0x=133:player0y=85 
  if var35{1} && var37=1 then gosub low:  player0x=133:player0y=85 

  if var35{2} && var37=2 then gosub hitoff: player0x=133:player0y=89 
  if var35{3} && var37=2 then gosub hiton:  player0x=133:player0y=85 

  if var35{4} && var37=3 then gosub high_grav: player0x=133:player0y=85
  if var35{5} && var37=3 then gosub low_grav:  player0x=133:player0y=85

  if var35{6} && var37=4 then gosub high_vel: player0x=133:player0y=85 
  if var35{7} && var37=4 then gosub low_vel:  player0x=133:player0y=85 

  if var41{0} && var37=5 then gosub high_playspeed: player0x=133:player0y=85 
  if var41{1} && var37=5 then gosub low_playspeed:  player0x=133:player0y=85 

  if var41{2} && var37=6 then gosub off_ran: player0x=133:player0y=89 
  if var41{3} && var37=6 then gosub on_ran:  player0x=133:player0y=85 

  drawscreen

  if joy0up then var38=var38-2
  if joy0down then var38=var38+2
 
  if var38>89 then var38=1

  if joy0fire && var23=0 then var23=1
  if !joy0fire && var23=1 then var23=2
  if joy0fire && var23=2 then goto begingame bank1

  if var37=1 && joy0right then gosub high
  if var37=1 && joy0left then gosub low

  if var37=2 && joy0right then gosub hiton
  if var37=2 && joy0left then gosub hitoff

  if var37=3 && joy0right then gosub high_grav
  if var37=3 && joy0left then gosub low_grav

  if var37=4 && joy0right then gosub high_vel
  if var37=4 && joy0left then gosub low_vel

  if var37=5 && joy0right then gosub high_playspeed
  if var37=5 && joy0left then gosub low_playspeed

  if var37=6 && joy0right then gosub off_ran
  if var37=6 && joy0left then gosub on_ran

  if var38>0  && var38<15 then var37=1:gosub speed 
  if var38>14 && var38<30 then var37=2:gosub god
  if var38>29 && var38<45 then var37=3:gosub gravity
  if var38>44 && var38<60 then var37=4:gosub velocity
  if var38>59 && var38<75 then var37=5:gosub playspeed
  if var38>74 && var38<90 then var37=6:gosub start_ran
 
  goto opt2


high
 player0:
 %00000000
 %10010111
 %10010010
 %11110010
 %10010010
 %10010111
end
 var35{0}=1:var35{1}=0
 return thisbank

low
 player0:
 %00000000
 %11101111
 %10001001
 %10001001
 %10001001
 %10001111
end
 var35{1}=1:var35{0}=0
 return thisbank

hitoff
 player0:
 %00000100
 %00000100
 %00000110
 %00000100
 %00000111
 %00010000
 %00010000
 %00011000
 %00010000
 %00011100
 %11100000
 %10100000
 %10100000
 %11100000
end
 var35{2}=1:var35{3}=0
 return thisbank

hiton
 player0:
 %00000000
 %11101001
 %10101001
 %10101011
 %10101101
 %11101001
end
 var35{3}=1:var35{2}=0
 return thisbank

high_grav
 player0:
 %00000000
 %10010111
 %10010010
 %11110010
 %10010010
 %10010111
end
 var35{4}=1:var35{5}=0
 return thisbank

low_grav
 player0:
 %00000000
 %11101111
 %10001001
 %10001001
 %10001001
 %10001111
end
 var35{5}=1:var35{4}=0
 return thisbank


high_vel
 player0:
 %00000000
 %10010111
 %10010010
 %11110010
 %10010010
 %10010111
end
 var35{6}=1:var35{7}=0
 return thisbank

low_vel
 player0:
 %00000000
 %11101111
 %10001001
 %10001001
 %10001001
 %10001111
end
 var35{7}=1:var35{6}=0
 return thisbank
 

high_playspeed
 player0:
 %00000000
 %10010111
 %10010010
 %11110010
 %10010010
 %10010111
end
 var41{0}=1:var41{1}=0
 return thisbank

low_playspeed
 player0:
 %00000000
 %11101111
 %10001001
 %10001001
 %10001001
 %10001111
end
 var41{1}=1:var41{0}=0
 return thisbank

off_ran
 player0:
 %00000100
 %00000100
 %00000110
 %00000100
 %00000111
 %00010000
 %00010000
 %00011000
 %00010000
 %00011100
 %11100000
 %10100000
 %10100000
 %11100000
end
 var41{2}=1:var41{3}=0
 return thisbank

on_ran
 player0:
 %00000000
 %11101001
 %10101001
 %10101011
 %10101101
 %11101001
end
 var41{3}=1:var41{2}=0
 return thisbank

speed
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXX.X.X...X...X...X...X...XXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XX...X...X...X.X...X.XXX.X...XX.
   XX.X.X.X.XX.XX.X.X.X..XX.X.XXXX.
   XX.X.X...XX.XX.X.X.X.X.X.X...XX.
   XX.X.X.XXXX.XX.X.X.X.XX..XXX.XX.
   XX...X.XXXX.XX.X...X.XXX.X...XX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXX..XXXX.XXXXX.................
   X..X.X..X...X...................
   XXXX.XXXX...X...................
   X..X.X..X...X...................
   XXX..X..X...X...................
   ................................
   XXXX.XXXX.XXXX.XXXX.XXX......XX.
   X....X..X.X....X....X..X....X..X
   XXXX.XXXX.XXX..XXX..X..X....X..X
   ...X.X....X....X....X..X....X..X
   XXXX.X....XXXX.XXXX.XXX......XX.
end
   var37=1
   return thisbank


god
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXX...X.X.X...X...X...X...XXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XX...X...X...X.X...X.XXX.X...XX.
   XX.X.X.X.XX.XX.X.X.X..XX.X.XXXX.
   XX.X.X...XX.XX.X.X.X.X.X.X...XX.
   XX.X.X.XXXX.XX.X.X.X.XX..XXX.XX.
   XX...X.XXXX.XX.X...X.XXX.X...XX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXXX.XXXX.XXX...................
   X....X..X.X..X..................
   X.XX.X..X.X..X..................
   X..X.X..X.X..X..................
   XXXX.XXXX.XXX...................
   ................................
   X...X.XXXX.XXX..XXXX.........XX.
   XX.XX.X..X.X..X.X...........X..X
   X.X.X.X..X.X..X.XXX.........X..X
   X...X.X..X.X..X.X...........X..X
   X...X.XXXX.XXX..XXXX.........XX.
end
   var37=2
   return thisbank

gravity
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXX...X...X.X.X...X...X...XXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XX...X...X...X.X...X.XXX.X...XX.
   XX.X.X.X.XX.XX.X.X.X..XX.X.XXXX.
   XX.X.X...XX.XX.X.X.X.X.X.X...XX.
   XX.X.X.XXXX.XX.X.X.X.XX..XXX.XX.
   XX...X.XXXX.XX.X...X.XXX.X...XX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXXXX.X..X.X...X.XXXX...........
   ..X...X..X.XX.XX.X..X...........
   ..X...X..X.X.X.X.XXXX...........
   ..X...X..X.X...X.X..............
   XXX...XXXX.X...X.X..............
   ................................
   XXXX.XXX.XXX.X.X.X.XXX.X.X...XX.
   X....X.X.X.X.X.X.X..X..X.X..X..X
   X.XX.XXX.XXX.X.X.X..X..X.X..X..X
   X..X.XX..X.X.X.X.X..X...X...X..X
   XXXX.X.X.X.X..X..X..X...X....XX.
end
   var37=3
   return thisbank

velocity
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXX...X...X...X.X.X...X...XXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XX...X...X...X.X...X.XXX.X...XX.
   XX.X.X.X.XX.XX.X.X.X..XX.X.XXXX.
   XX.X.X...XX.XX.X.X.X.X.X.X...XX.
   XX.X.X.XXXX.XX.X.X.X.XX..XXX.XX.
   XX...X.XXXX.XX.X...X.XXX.X...XX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXXXX.X..X.X...X.XXXX...........
   ..X...X..X.XX.XX.X..X...........
   ..X...X..X.X.X.X.XXXX...........
   ..X...X..X.X...X.X..............
   XXX...XXXX.X...X.X..............
   ................................
   X.X.XX.X..XXX.XX.X.XXX.X.X...XX.
   X.X.X..X..X.X.X..X..X..X.X..X..X
   X.X.XX.X..X.X.X..X..X..X.X..X..X
   X.X.X..X..X.X.X..X..X...X...X..X
   .X..XX.XX.XXX.XX.X..X...X....XX.
end
   var37=4
   return thisbank

playspeed
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXX...X...X...X...X.X.X...XXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XX...X...X...X.X...X.XXX.X...XX.
   XX.X.X.X.XX.XX.X.X.X..XX.X.XXXX.
   XX.X.X...XX.XX.X.X.X.X.X.X...XX.
   XX.X.X.XXXX.XX.X.X.X.XX..XXX.XX.
   XX...X.XXXX.XX.X...X.XXX.X...XX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXXX.X...XXXX.X...X.XXXX.XXXX...
   X..X.X...X..X..X.X..X....X..X...
   XXXX.X...XXXX...X...XXXX.XXXX...
   X....X...X..X...X...X....X.X....
   X....XXX.X..X...X...XXXX.X..X...
   ................................
   XXXX.XXXX.XXXX.XXXX.XXX......XX.
   X....X..X.X....X....X..X....X..X
   XXXX.XXXX.XXX..XXX..X..X....X..X
   ...X.X....X....X....X..X....X..X
   XXXX.X....XXXX.XXXX.XXX......XX.
end
   var37=5
   return thisbank

start_ran
   playfield:
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXX...X...X...X...X...X.X.XXXX.
   XXXX...X...X...X...X...X...XXXX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   XX...X...X...X.X...X.XXX.X...XX.
   XX.X.X.X.XX.XX.X.X.X..XX.X.XXXX.
   XX.X.X...XX.XX.X.X.X.X.X.X...XX.
   XX.X.X.XXXX.XX.X.X.X.XX..XXX.XX.
   XX...X.XXXX.XX.X...X.XXX.X...XX.
   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
   ................................
   XXXX.XXXX.X..X.XXX..XXXX.X...X..
   X..X.X..X.XX.X.X..X.X..X.XX.XX..
   XXXX.XXXX.X.XX.X..X.X..X.X.X.X..
   X.X..X..X.X..X.X..X.X..X.X...X..
   X..X.X..X.X..X.XXX..XXXX.X...X..
   ................................
   XXXX.XXXXX.XXXX.XXXX.XXXXX...XX.
   X......X...X..X.X..X...X....X..X
   XXXX...X...XXXX.XXXX...X....X..X
   ...X...X...X..X.X.X....X....X..X
   XXXX...X...X..X.X..X...X.....XX.
end
   var37=6
   return thisbank


 inline score51.asm

 vblank
 REFP0=flags
 return
